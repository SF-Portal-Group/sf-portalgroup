<div class="footer_row3">
    <div>
        <img src="con/SF-PoweredBy2024-260w-White.png" alt="Online Storefront Powered by Strategic Factory">
    </div>

    <p class="footer_cr">
        Strategic Factory<br>
        11195 Dolfield Boulevard<br>
        Owings Mills, Maryland 21117<br>
        (443) 548-3500<br>
        <a href="mailto:sfportalorders@strategicfactory.com">sfportalorders@strategicfactory.com</a>
    </p>
</div>

<script>
    /**
     * Changes classes and deletes inline styles to prepare the site for proper CSS application.
     */
    function normalize() {
        // Doesn't seem to work; it appears to put back the inline styles every time the viewport size changes??????
        // $("#all_items_view").removeAttr("style");
    }

    /**
     * Creates a header nav with the catalog tabs and links, and hides the original header and tabs container.
     */
    function tabsToNav() {
        $("#header-wrapper").after(`<header><nav><ul class="nav">`);
        $("#header_logo img").prependTo("header nav");

        // For each tab in the original tab container:
        $(`#tab_responsive_tabs [id^="tab_"]`).each(function() {
            // If the tab has no sub-items, add it to the nav as a link.
            if ( $(this).find("dfn").length === 1 ) {
                $(".nav").append(`<li>${ $(this).find("dfn").first().html() }</li>`);
            }

            // If it does have sub-items, add it to the nav as a hoverable container.
            else {
                let menu = $(`
                    <li class="nav__tab-drop">
                        <a>
                            <span>${ $(this).find("dfn").first().text() }</span>
                            <i class="fa fa-sort-desc"></i>
                        </a>
                    </li>
                `);

                let sub = $(`<ul class="nav__tab-menu">`);

                // For each child tab:
                $(this).children().find('dfn').each(function() {
                    // If it does not have any children, add it to the parent menu as a link.
                    if ( $(this).is(":last-child") ) {
                        sub.append(`<li>${ $(this).html() }</li>`);
                    }
                });

                menu.append(sub);
                $(".nav").append(menu);
            }
        });

        // Add the basket link from the original header.
        $(".nav").append(`<li><a href="basket_view.cgi"><i class="fa fa-shopping-basket"></i><span>${ $(".cart_num_items").text() }</span></a></li>`);

        // Create a new submenu with the profile and logout links.
        $(".nav").append(`
            <li class="nav__tab-drop">
                <a>
                    <span>${ $("#logout_userid").text() }</span>
                    <i class="fa fa-sort-desc"></i>
                </a>
                <ul class="nav__tab-menu">
                    <li><a href="profile.cgi?force_view=1">My Profile</a></li>
                    <li><a href="cancel.cgi">Cancel Order</a></li>
                    <li><a id="submit_logout" href="logout.cgi">Logout</a></li>
                </ul>
            </li>
        `);

        // If user is not viewing the catalog page, insert a link to the catalog.
        if ( !$(".select-items").length ) {
            $(".nav").prepend(`<li><a href="catalog.cgi">Back to Catalog</a></li>`);
        }
    }

    /**
     * Sets the height of each item in the selector to the height of the tallest item.
     */
    function setSelectorHeight(selector) {
        let maxHeight = 0;

        $(selector).each(function() {
            if ( $(this).height() > maxHeight ) {
                maxHeight = $(this).height();
            }
        });

        $(selector).css("height", `${ Math.ceil(maxHeight) }px`);
    }

    /**
     * Makes all catalog products the same height by equalizing the height of each component across all items.
     */
    function equalizeItemHeights() {
        // Adds a thumbnail container to any item that doesn't already have one.
        $(".image-container:not(:has(.multi_preview))").append(`<div class="multi_preview">`);

        // If there are any items on the page that have tiny thumbnails:
        // Adds the current image as a tiny thumbnail to items that don't already have one.
        if ( $(".multi_preview").find("img").length !== 0 ) {
            $(".multi_preview:not(:has(img))").each(function() {
                $(this).append(`<img class="catalog-tiny-thumbnail" src="${ $(this).siblings("a").find("img").attr("src") }" />`);
            });
        }

        // Wraps the pricing and onhand lines together to avoid awkward spacing.
        $(".height-adjuster").each(function() {
            let wrapper = $(`<div class="product__stock">`)
                .insertBefore( $(this).find(".responsive-pricing").first() );

            $(this).find(".responsive-pricing, .responsive-onhand").appendTo(wrapper);
        });

        setSelectorHeight(".image-container");
        setSelectorHeight(".responsive-longname");
        setSelectorHeight(".responsive-choose-info");
        setSelectorHeight(".product__stock");
    }



    $(document).ready(function() {
        normalize();
        tabsToNav();
        equalizeItemHeights();
    });
</script>